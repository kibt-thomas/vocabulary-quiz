<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard Language Quiz - v1.0.3</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col items-center min-h-screen p-4">

    <div class="w-full max-w-md mx-auto">
        <header class="bg-white p-4 rounded-xl shadow-lg mb-6 sticky top-4 z-10">
            <div class="flex justify-between items-center">
                <button id="header-quiz-btn" class="text-xl font-bold text-slate-700 hover:text-[var(--primary-600)] transition-colors text-left">
                    <span>Vocabulary Quiz</span>
                </button>
                <div class="relative" id="nav-dropdown-container">
                    <button id="nav-toggle-btn" class="w-10 h-10 rounded-full bg-[var(--primary-600)] text-white flex items-center justify-center font-bold text-lg hover:bg-[var(--primary-700)] transition-colors">
                        <span id="nav-avatar-initial">B</span>
                    </button>
                    <div id="nav-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-xl py-1">
                        <a href="#" data-page="main-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Quiz Hub</a>
                        <a href="#" data-page="list-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Phrase List</a>
                        <a href="#" data-page="add-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Add Phrases</a>
                        <a href="#" data-page="stats-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Statistics</a>
                        <a href="#" data-page="history-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Quiz History</a>
                        <a href="#" data-page="settings-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">Settings</a>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div id="main-page" class="page active">
                <div class="text-center bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">Ready to learn, <span id="main-page-nickname" class="nickname-color"></span>?</h2>
                    <p class="text-slate-500 mt-2 mb-6">Start a new quiz session to practice your vocabulary.</p>
                    <button id="go-to-quiz-setup-btn" class="w-full bg-[var(--accent-500)] text-white font-bold py-3 px-4 rounded-lg hover:bg-[var(--accent-600)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent-500)] transition-colors text-lg">
                        Start Quiz
                    </button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                     <h3 class="text-xl font-semibold mb-4 text-slate-700">Quiz Suggestions</h3>
                     <div id="quiz-suggestions" class="space-y-3">
                        <p class="text-sm text-slate-500">Practice some phrases to get suggestions here!</p>
                     </div>
                </div>
            </div>

            <div id="list-page" class="page">
                 <div id="card-list-container" class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Your Phrases (<span id="card-count">0</span>)</h2>
                     <div id="card-list" class="space-y-4 max-h-[60vh] overflow-y-auto"></div>
                </div>
            </div>

            <div id="add-page" class="page">
                <div id="add-card-section" class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Add or Update a Phrase</h2>
                    <form id="add-card-form" class="space-y-4">
                        <div>
                            <label for="lecture" class="block text-sm font-medium text-slate-600">Lecture / Group</label>
                            <input type="text" id="lecture" placeholder="e.g., Chapter 1" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                        </div>
                        <div>
                            <label for="english-word" class="block text-sm font-medium text-slate-600">Native Language</label>
                            <input type="text" id="english-word" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                        </div>
                        <div>
                            <label for="german-word" class="block text-sm font-medium text-slate-600">Foreign Language</label>
                            <input type="text" id="german-word" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                        </div>
                        <div>
                            <button type="submit" class="w-full bg-[var(--primary-600)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-500)] transition-colors">Add / Update Phrase</button>
                        </div>
                    </form>
                </div>
                 <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Manage All App Data</h2>
                    <div class="flex gap-4">
                        <button id="import-btn" class="w-full flex items-center justify-center gap-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-3 rounded-lg transition-colors">Import Data</button>
                        <input type="file" id="import-file-input" class="hidden" accept=".json">
                        <button id="export-btn" class="w-full flex items-center justify-center gap-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-3 rounded-lg transition-colors">Export Data</button>
                    </div>
                </div>
            </div>

            <div id="stats-page" class="page">
                 <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Performance Statistics</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                <tr>
                                    <th scope="col" class="px-4 py-3">Quiz Mode</th>
                                    <th scope="col" class="px-4 py-3 text-center">Correct</th>
                                    <th scope="col" class="px-4 py-3 text-center">Incorrect</th>
                                    <th scope="col" class="px-4 py-3 text-center">Success %</th>
                                </tr>
                            </thead>
                            <tbody id="stats-table-body">
                            </tbody>
                        </table>
                    </div>
                 </div>
            </div>

            <div id="history-page" class="page">
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Quiz History</h2>
                    <div id="history-list" class="space-y-4 max-h-[60vh] overflow-y-auto">
                    </div>
                </div>
            </div>

            <div id="settings-page" class="page">
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h2 class="text-xl font-semibold mb-4">Settings</h2>
                    <form id="settings-form" class="space-y-6">
                        <div>
                            <h3 class="font-medium text-slate-600 mb-2">Personalization</h3>
                             <div class="space-y-4">
                                <div>
                                    <label for="nickname-input" class="block text-sm font-medium text-slate-600">Nickname</label>
                                    <input type="text" id="nickname-input" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                </div>
                                <div>
                                    <label for="theme-select" class="block text-sm font-medium text-slate-600">Theme</label>
                                    <select id="theme-select" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                        <option value="purple">Purple (Default)</option>
                                        <option value="blue">Light Blue</option>
                                        <option value="green">Green</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="font-medium text-slate-600 mb-2">Language Selection</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="native-lang-select" class="block text-sm font-medium text-slate-600">Your Native Language</label>
                                    <select id="native-lang-select" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]"></select>
                                </div>
                                <div>
                                    <label for="foreign-lang-select" class="block text-sm font-medium text-slate-600">Language to Learn</label>
                                    <select id="foreign-lang-select" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]"></select>
                                </div>
                            </div>
                        </div>

                         <div>
                            <h3 class="font-medium text-slate-600 mb-2">Quiz Behavior</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="auto-advance-correct-time" class="block text-sm font-medium text-slate-600">Auto-Advance on Correct (sec)</label>
                                    <input type="number" id="auto-advance-correct-time" min="0" max="60" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                </div>
                                <div>
                                    <label for="auto-advance-wrong-time" class="block text-sm font-medium text-slate-600">Auto-Advance on Wrong (sec)</label>
                                    <input type="number" id="auto-advance-wrong-time" min="1" max="60" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                </div>
                                 <div>
                                    <label for="max-quiz-questions" class="block text-sm font-medium text-slate-600">Max Questions per Quiz</label>
                                    <input type="number" id="max-quiz-questions" min="5" max="100" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                </div>
                                 <div>
                                    <label for="repeat-after-input" class="block text-sm font-medium text-slate-600">Repeat After Failure (questions)</label>
                                    <input type="number" id="repeat-after-input" min="1" max="20" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                                </div>
                            </div>
                        </div>
                        <div>
                             <h3 class="font-medium text-slate-600 mb-2">Spaced Repetition Bins</h3>
                             <div class="space-y-3">
                                 <div>
                                     <label for="bin1-threshold" class="flex justify-between text-sm font-medium text-slate-600"><span>Needs Practice</span> <span id="bin1-label">0-25%</span></label>
                                     <input type="range" id="bin1-threshold" min="10" max="48" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                 </div>
                                 <div>
                                     <label for="bin2-threshold" class="flex justify-between text-sm font-medium text-slate-600"><span>Getting There</span> <span id="bin2-label">25-50%</span></label>
                                     <input type="range" id="bin2-threshold" min="26" max="73" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                 </div>
                                 <div>
                                     <label for="bin3-threshold" class="flex justify-between text-sm font-medium text-slate-600"><span>Good Job</span> <span id="bin3-label">50-75%</span></label>
                                     <input type="range" id="bin3-threshold" min="51" max="98" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                 </div>
                             </div>
                        </div>
                        <div>
                             <button type="button" id="save-settings-btn" class="w-full bg-[var(--primary-600)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-500)] transition-colors">Save Settings</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>

        <footer class="text-center text-xs text-slate-400 mt-6 pb-4">
            <p>Vocabulary Quiz - v1.0.3</p>
        </footer>
        
        <div id="quiz-setup-view" class="hidden fixed inset-x-4 top-1/2 -translate-y-1/2 max-w-md mx-auto z-20 bg-white rounded-xl shadow-lg flex flex-col max-h-[90vh]">
             <div class="p-6 overflow-y-auto">
                <h2 class="text-xl font-semibold mb-4 text-center">Quiz Setup</h2>
                <div class="space-y-5">
                    <div>
                        <h3 class="font-medium text-slate-600 mb-2">1. Choose Lecture</h3>
                        <select id="quiz-lecture-filter" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]"></select>
                    </div>
                    <div>
                        <h3 class="font-medium text-slate-600 mb-2">2. Choose Direction</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="radio" name="quiz-direction" id="dir-en-de" value="native-to-foreign" class="hidden">
                            <label for="dir-en-de" class="block text-center p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">Native → Foreign</label>
                            <input type="radio" name="quiz-direction" id="dir-de-en" value="foreign-to-native" class="hidden">
                            <label for="dir-de-en" class="block text-center p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">Foreign → Native</label>
                        </div>
                         <div class="mt-3">
                             <input type="radio" name="quiz-direction" id="dir-mixed" value="mixed" class="hidden" checked>
                             <label for="dir-mixed" class="block text-center p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">Mixed</label>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-medium text-slate-600 mb-2">3. Choose Mode</h3>
                        <div class="space-y-2">
                            <input type="radio" name="quiz-mode" id="mode-typing" value="typing" class="hidden">
                            <label for="mode-typing" class="block w-full text-left p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">📝 Type the answer</label>
                            <input type="radio" name="quiz-mode" id="mode-choice" value="choice" class="hidden" checked>
                            <label for="mode-choice" class="block w-full text-left p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">🖱️ Multiple choice</label>
                            <input type="radio" name="quiz-mode" id="mode-speech" value="speech" class="hidden">
                            <label for="mode-speech" class="block w-full text-left p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">🗣️ Speak the answer</label>
                        </div>
                    </div>
                </div>
                <div class="mt-6 flex flex-col gap-2">
                    <button id="start-quiz-btn" class="w-full bg-[var(--accent-500)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--accent-600)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent-500)] transition-colors">Let's Go!</button>
                    <button id="back-to-main-btn" class="w-full text-center text-sm text-slate-500 hover:text-slate-700 py-1">Cancel</button>
                </div>
            </div>
        </div>

        <div id="quiz-section" class="hidden fixed inset-x-4 top-1/2 -translate-y-1/2 max-w-md mx-auto z-20 bg-white rounded-xl shadow-lg flex flex-col max-h-[90vh]">
            <div class="p-6 overflow-y-auto">
                <div class="text-center mb-4">
                    <div id="quiz-prompt" class="flex items-center justify-center gap-2">
                        <p id="quiz-word" class="text-3xl font-bold text-slate-700"></p>
                        <button id="speak-question-btn" class="hidden p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-600"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                        </button>
                    </div>
                    <p id="quiz-prompt-text" class="text-sm text-slate-500 mt-2"></p>
                </div>
                <div id="quiz-input-area" class="space-y-4">
                    <div id="typing-input-container" class="hidden">
                        <input type="text" id="answer-input" placeholder="Type your answer here..." class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-[var(--primary-500)] focus:ring-1 focus:ring-[var(--primary-500)]">
                        <button id="check-answer-btn" class="mt-4 w-full bg-[var(--primary-600)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-500)] transition-colors">Check Answer</button>
                    </div>
                    <div id="choice-input-container" class="hidden space-y-2"></div>
                    <div id="speech-input-container" class="hidden text-center">
                        <button id="listen-btn" class="w-full flex items-center justify-center gap-2 bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 focus:outline-none transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line></svg>
                            <span id="listen-btn-text">Start Listening</span>
                        </button>
                        <p id="speech-recognition-status" class="text-sm text-slate-500 mt-2 h-5"></p>
                    </div>
                </div>
                <div id="result-area" class="hidden text-center mt-4 p-4 rounded-lg">
                    <p id="result-text" class="font-semibold text-lg"></p>
                    <div class="flex items-center justify-center gap-2 mt-2">
                        <p id="correct-answer-text" class="text-slate-600"></p>
                        <button id="speak-btn" class="p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-600"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                        </button>
                    </div>
                    <button id="next-question-btn" class="mt-4 w-full bg-[var(--accent-500)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--accent-600)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--accent-500)] transition-colors">Next</button>
                </div>
                <p id="quiz-reason" class="text-xs text-center text-slate-500 mt-4 mb-2 h-4"></p>
                <div class="mt-2">
                    <div class="flex justify-between text-sm text-slate-500 mb-1">
                        <span>Progress</span>
                        <span id="progress-text">0 / 0</span>
                    </div>
                    <div class="w-full bg-slate-200 rounded-full h-2.5">
                        <div id="progress-bar" class="bg-[var(--primary-600)] h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                <button id="end-quiz-btn" class="mt-4 w-full text-center text-sm text-slate-500 hover:text-slate-700">End Quiz</button>
            </div>
        </div>
        
        <div id="quiz-feedback-view" class="hidden fixed inset-x-4 top-1/2 -translate-y-1/2 max-w-md mx-auto z-20 bg-white rounded-xl shadow-lg flex flex-col max-h-[90vh]">
            <div class="p-6 overflow-y-auto text-center">
                <h2 id="feedback-title" class="text-2xl font-bold text-slate-800 mb-2">Quiz Complete!</h2>
                <div id="feedback-stars" class="text-5xl my-4"></div>
                <p id="feedback-message" class="text-slate-600 mb-4"></p>
                <p class="font-semibold text-lg"><span id="feedback-correct">0</span> / <span id="feedback-total">0</span> correct</p>
                <button id="back-to-hub-btn" class="mt-6 w-full bg-[var(--primary-600)] text-white font-bold py-2 px-4 rounded-lg hover:bg-[var(--primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary-500)] transition-colors">Back to Quiz Hub</button>
            </div>
        </div>

        <div id="modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-10"></div>

        <div id="toast" class="toast fixed bottom-5 right-5 bg-slate-800 text-white py-2 px-4 rounded-lg shadow-xl z-30">
            <span id="toast-message"></span>
        </div>
    </div>

    <script src="dictionary.js"></script>
    <script src="app.js"></script>
</body>
</html>

